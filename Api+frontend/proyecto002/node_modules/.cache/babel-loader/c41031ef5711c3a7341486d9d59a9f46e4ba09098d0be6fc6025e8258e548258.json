{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\nandi\\\\Proyecto-Desarrollo-Web-Avanzada\\\\Api+frontend\\\\proyecto002\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport \"./App.css\";\nimport { useEffect, useState } from \"react\";\nimport ProductForm from \"./components/ProductForm\";\nimport ProductList from \"./components/ProductList\";\nimport { obtenerProductos, crearProducto, actualizarProducto, eliminarProducto } from \"./services/productService\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  const [productos, setProductos] = useState([]);\n  const [cargando, setCargando] = useState(true);\n\n  // useEffect: se ejecuta una sola vez al montar el componente\n  useEffect(() => {\n    async function cargarDatos() {\n      try {\n        const data = await obtenerProductos();\n        setProductos(data);\n      } catch (error) {\n        console.error(\"Error al cargar productos:\", error);\n      } finally {\n        setCargando(false);\n      }\n    }\n    cargarDatos();\n  }, []); // [] → solo una vez (como componentDidMount)\n\n  //  Evento que viene del hijo ProductForm\n  async function handleCrear(productoNuevo) {\n    try {\n      const creado = await crearProducto(productoNuevo);\n      let creadoConId;\n      setProductos(prev => {\n        const maxId = prev.reduce((m, it) => {\n          const n = Number(it === null || it === void 0 ? void 0 : it.id);\n          return Number.isFinite(n) && !Number.isNaN(n) ? Math.max(m, n) : m;\n        }, 0);\n        const assignedId = maxId + 1; // siempre siguiente secuencial\n        creadoConId = {\n          ...creado,\n          id: assignedId\n        };\n        return [...prev, creadoConId];\n      });\n      return creadoConId;\n    } catch (error) {\n      console.error(\"Error al crear producto:\", error);\n      throw error;\n    }\n  }\n\n  // NUEVO: actualizar producto (usa actualizarProducto del service) con fallback local\n  async function handleActualizar(id, cambios) {\n    try {\n      var _actualizado$id;\n      const actualizado = await actualizarProducto(id, cambios);\n      // usar id devuelto por la API si existe, sino el id solicitado\n      const idToMatch = (_actualizado$id = actualizado === null || actualizado === void 0 ? void 0 : actualizado.id) !== null && _actualizado$id !== void 0 ? _actualizado$id : id;\n      setProductos(prev => prev.map(p => p.id === idToMatch ? actualizado : p));\n      return actualizado;\n    } catch (error) {\n      // fallback: actualizar localmente si existe (producto creado localmente)\n      console.warn(\"Fallo actualización remota, aplicando cambios localmente:\", error);\n      const idNum = typeof id === \"string\" && /^\\d+$/.test(id) ? Number(id) : id;\n      const local = productos.find(p => p.id === idNum || String(p.id) === String(id));\n      if (local) {\n        const merged = {\n          ...local,\n          ...cambios,\n          id: local.id\n        };\n        setProductos(prev => prev.map(p => p.id === local.id ? merged : p));\n        return merged;\n      }\n      console.error(\"Producto no encontrado localmente para id:\", id);\n      throw error;\n    }\n  }\n\n  // NUEVO: eliminar producto (usa eliminarProducto del service) con fallback local\n  async function handleEliminar(id) {\n    try {\n      const resp = await eliminarProducto(id);\n      setProductos(prev => prev.filter(p => !(p.id === id || String(p.id) === String(id))));\n      return resp;\n    } catch (error) {\n      // fallback: eliminar localmente si existe\n      console.warn(\"Fallo eliminación remota, eliminando localmente:\", error);\n      const idNum = typeof id === \"string\" && /^\\d+$/.test(id) ? Number(id) : id;\n      const exists = productos.some(p => p.id === idNum || String(p.id) === String(id));\n      if (exists) {\n        setProductos(prev => prev.filter(p => !(p.id === idNum || String(p.id) === String(id))));\n        return {\n          id\n        };\n      }\n      console.error(\"Producto no encontrado localmente para id:\", id);\n      throw error;\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"app-card\",\n      children: [/*#__PURE__*/_jsxDEV(\"header\", {\n        className: \"app-header\",\n        children: /*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"app-title\",\n          children: [\"Consumo de Api\", /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"app-sub\",\n            children: \"DummyJSON\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ProductForm, {\n        onCrear: handleCrear\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 9\n      }, this), cargando ? /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"note\",\n        children: \"Cargando productos...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(ProductList, {\n        productos: productos,\n        onActualizar: handleActualizar,\n        onEliminar: handleEliminar\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 100,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"ytxkAgtCFo+bfgxo1JtKqHYTG44=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["useEffect","useState","ProductForm","ProductList","obtenerProductos","crearProducto","actualizarProducto","eliminarProducto","jsxDEV","_jsxDEV","App","_s","productos","setProductos","cargando","setCargando","cargarDatos","data","error","console","handleCrear","productoNuevo","creado","creadoConId","prev","maxId","reduce","m","it","n","Number","id","isFinite","isNaN","Math","max","assignedId","handleActualizar","cambios","_actualizado$id","actualizado","idToMatch","map","p","warn","idNum","test","local","find","String","merged","handleEliminar","resp","filter","exists","some","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onCrear","onActualizar","onEliminar","_c","$RefreshReg$"],"sources":["C:/Users/nandi/Proyecto-Desarrollo-Web-Avanzada/Api+frontend/proyecto002/src/App.js"],"sourcesContent":["import \"./App.css\";\r\nimport { useEffect, useState } from \"react\";\r\nimport ProductForm from \"./components/ProductForm\";\r\nimport ProductList from \"./components/ProductList\";\r\nimport {\r\n  obtenerProductos,\r\n  crearProducto,\r\n  actualizarProducto,\r\n  eliminarProducto\r\n} from \"./services/productService\";\r\n\r\nfunction App() {\r\n  const [productos, setProductos] = useState([]);\r\n  const [cargando, setCargando] = useState(true);\r\n\r\n  // useEffect: se ejecuta una sola vez al montar el componente\r\n  useEffect(() => {\r\n    async function cargarDatos() {\r\n      try {\r\n        const data = await obtenerProductos();\r\n        setProductos(data);\r\n      } catch (error) {\r\n        console.error(\"Error al cargar productos:\", error);\r\n      } finally {\r\n        setCargando(false);\r\n      }\r\n    }\r\n\r\n    cargarDatos();\r\n  }, []); // [] → solo una vez (como componentDidMount)\r\n\r\n  //  Evento que viene del hijo ProductForm\r\n  async function handleCrear(productoNuevo) {\r\n    try {\r\n      const creado = await crearProducto(productoNuevo);\r\n\r\n      let creadoConId;\r\n      setProductos((prev) => {\r\n        const maxId = prev.reduce((m, it) => {\r\n          const n = Number(it?.id);\r\n          return Number.isFinite(n) && !Number.isNaN(n) ? Math.max(m, n) : m;\r\n        }, 0);\r\n\r\n        const assignedId = maxId + 1; // siempre siguiente secuencial\r\n        creadoConId = { ...creado, id: assignedId };\r\n        return [...prev, creadoConId];\r\n      });\r\n\r\n      return creadoConId;\r\n    } catch (error) {\r\n      console.error(\"Error al crear producto:\", error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  // NUEVO: actualizar producto (usa actualizarProducto del service) con fallback local\r\n  async function handleActualizar(id, cambios) {\r\n    try {\r\n      const actualizado = await actualizarProducto(id, cambios);\r\n      // usar id devuelto por la API si existe, sino el id solicitado\r\n      const idToMatch = actualizado?.id ?? id;\r\n      setProductos((prev) => prev.map((p) => (p.id === idToMatch ? actualizado : p)));\r\n      return actualizado;\r\n    } catch (error) {\r\n      // fallback: actualizar localmente si existe (producto creado localmente)\r\n      console.warn(\"Fallo actualización remota, aplicando cambios localmente:\", error);\r\n      const idNum = typeof id === \"string\" && /^\\d+$/.test(id) ? Number(id) : id;\r\n      const local = productos.find((p) => p.id === idNum || String(p.id) === String(id));\r\n      if (local) {\r\n        const merged = { ...local, ...cambios, id: local.id };\r\n        setProductos((prev) => prev.map((p) => (p.id === local.id ? merged : p)));\r\n        return merged;\r\n      }\r\n      console.error(\"Producto no encontrado localmente para id:\", id);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  // NUEVO: eliminar producto (usa eliminarProducto del service) con fallback local\r\n  async function handleEliminar(id) {\r\n    try {\r\n      const resp = await eliminarProducto(id);\r\n      setProductos((prev) => prev.filter((p) => !(p.id === id || String(p.id) === String(id))));\r\n      return resp;\r\n    } catch (error) {\r\n      // fallback: eliminar localmente si existe\r\n      console.warn(\"Fallo eliminación remota, eliminando localmente:\", error);\r\n      const idNum = typeof id === \"string\" && /^\\d+$/.test(id) ? Number(id) : id;\r\n      const exists = productos.some((p) => p.id === idNum || String(p.id) === String(id));\r\n      if (exists) {\r\n        setProductos((prev) => prev.filter((p) => !(p.id === idNum || String(p.id) === String(id))));\r\n        return { id };\r\n      }\r\n      console.error(\"Producto no encontrado localmente para id:\", id);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <div className=\"app-card\">\r\n        <header className=\"app-header\">\r\n          <h1 className=\"app-title\">\r\n            Consumo de Api\r\n            <span className=\"app-sub\">DummyJSON</span>\r\n          </h1>\r\n        </header>\r\n\r\n        {/* HIJO que genera evento */}\r\n        <ProductForm onCrear={handleCrear} />\r\n\r\n        {cargando ? (\r\n          <p className=\"note\">Cargando productos...</p>\r\n        ) : (\r\n          <ProductList\r\n            productos={productos}\r\n            onActualizar={handleActualizar}\r\n            onEliminar={handleEliminar}\r\n          />\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;"],"mappings":";;AAAA,OAAO,WAAW;AAClB,SAASA,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC3C,OAAOC,WAAW,MAAM,0BAA0B;AAClD,OAAOC,WAAW,MAAM,0BAA0B;AAClD,SACEC,gBAAgB,EAChBC,aAAa,EACbC,kBAAkB,EAClBC,gBAAgB,QACX,2BAA2B;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEnC,SAASC,GAAGA,CAAA,EAAG;EAAAC,EAAA;EACb,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGZ,QAAQ,CAAC,EAAE,CAAC;EAC9C,MAAM,CAACa,QAAQ,EAAEC,WAAW,CAAC,GAAGd,QAAQ,CAAC,IAAI,CAAC;;EAE9C;EACAD,SAAS,CAAC,MAAM;IACd,eAAegB,WAAWA,CAAA,EAAG;MAC3B,IAAI;QACF,MAAMC,IAAI,GAAG,MAAMb,gBAAgB,CAAC,CAAC;QACrCS,YAAY,CAACI,IAAI,CAAC;MACpB,CAAC,CAAC,OAAOC,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;MACpD,CAAC,SAAS;QACRH,WAAW,CAAC,KAAK,CAAC;MACpB;IACF;IAEAC,WAAW,CAAC,CAAC;EACf,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;;EAER;EACA,eAAeI,WAAWA,CAACC,aAAa,EAAE;IACxC,IAAI;MACF,MAAMC,MAAM,GAAG,MAAMjB,aAAa,CAACgB,aAAa,CAAC;MAEjD,IAAIE,WAAW;MACfV,YAAY,CAAEW,IAAI,IAAK;QACrB,MAAMC,KAAK,GAAGD,IAAI,CAACE,MAAM,CAAC,CAACC,CAAC,EAAEC,EAAE,KAAK;UACnC,MAAMC,CAAC,GAAGC,MAAM,CAACF,EAAE,aAAFA,EAAE,uBAAFA,EAAE,CAAEG,EAAE,CAAC;UACxB,OAAOD,MAAM,CAACE,QAAQ,CAACH,CAAC,CAAC,IAAI,CAACC,MAAM,CAACG,KAAK,CAACJ,CAAC,CAAC,GAAGK,IAAI,CAACC,GAAG,CAACR,CAAC,EAAEE,CAAC,CAAC,GAAGF,CAAC;QACpE,CAAC,EAAE,CAAC,CAAC;QAEL,MAAMS,UAAU,GAAGX,KAAK,GAAG,CAAC,CAAC,CAAC;QAC9BF,WAAW,GAAG;UAAE,GAAGD,MAAM;UAAES,EAAE,EAAEK;QAAW,CAAC;QAC3C,OAAO,CAAC,GAAGZ,IAAI,EAAED,WAAW,CAAC;MAC/B,CAAC,CAAC;MAEF,OAAOA,WAAW;IACpB,CAAC,CAAC,OAAOL,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;MAChD,MAAMA,KAAK;IACb;EACF;;EAEA;EACA,eAAemB,gBAAgBA,CAACN,EAAE,EAAEO,OAAO,EAAE;IAC3C,IAAI;MAAA,IAAAC,eAAA;MACF,MAAMC,WAAW,GAAG,MAAMlC,kBAAkB,CAACyB,EAAE,EAAEO,OAAO,CAAC;MACzD;MACA,MAAMG,SAAS,IAAAF,eAAA,GAAGC,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAET,EAAE,cAAAQ,eAAA,cAAAA,eAAA,GAAIR,EAAE;MACvClB,YAAY,CAAEW,IAAI,IAAKA,IAAI,CAACkB,GAAG,CAAEC,CAAC,IAAMA,CAAC,CAACZ,EAAE,KAAKU,SAAS,GAAGD,WAAW,GAAGG,CAAE,CAAC,CAAC;MAC/E,OAAOH,WAAW;IACpB,CAAC,CAAC,OAAOtB,KAAK,EAAE;MACd;MACAC,OAAO,CAACyB,IAAI,CAAC,2DAA2D,EAAE1B,KAAK,CAAC;MAChF,MAAM2B,KAAK,GAAG,OAAOd,EAAE,KAAK,QAAQ,IAAI,OAAO,CAACe,IAAI,CAACf,EAAE,CAAC,GAAGD,MAAM,CAACC,EAAE,CAAC,GAAGA,EAAE;MAC1E,MAAMgB,KAAK,GAAGnC,SAAS,CAACoC,IAAI,CAAEL,CAAC,IAAKA,CAAC,CAACZ,EAAE,KAAKc,KAAK,IAAII,MAAM,CAACN,CAAC,CAACZ,EAAE,CAAC,KAAKkB,MAAM,CAAClB,EAAE,CAAC,CAAC;MAClF,IAAIgB,KAAK,EAAE;QACT,MAAMG,MAAM,GAAG;UAAE,GAAGH,KAAK;UAAE,GAAGT,OAAO;UAAEP,EAAE,EAAEgB,KAAK,CAAChB;QAAG,CAAC;QACrDlB,YAAY,CAAEW,IAAI,IAAKA,IAAI,CAACkB,GAAG,CAAEC,CAAC,IAAMA,CAAC,CAACZ,EAAE,KAAKgB,KAAK,CAAChB,EAAE,GAAGmB,MAAM,GAAGP,CAAE,CAAC,CAAC;QACzE,OAAOO,MAAM;MACf;MACA/B,OAAO,CAACD,KAAK,CAAC,4CAA4C,EAAEa,EAAE,CAAC;MAC/D,MAAMb,KAAK;IACb;EACF;;EAEA;EACA,eAAeiC,cAAcA,CAACpB,EAAE,EAAE;IAChC,IAAI;MACF,MAAMqB,IAAI,GAAG,MAAM7C,gBAAgB,CAACwB,EAAE,CAAC;MACvClB,YAAY,CAAEW,IAAI,IAAKA,IAAI,CAAC6B,MAAM,CAAEV,CAAC,IAAK,EAAEA,CAAC,CAACZ,EAAE,KAAKA,EAAE,IAAIkB,MAAM,CAACN,CAAC,CAACZ,EAAE,CAAC,KAAKkB,MAAM,CAAClB,EAAE,CAAC,CAAC,CAAC,CAAC;MACzF,OAAOqB,IAAI;IACb,CAAC,CAAC,OAAOlC,KAAK,EAAE;MACd;MACAC,OAAO,CAACyB,IAAI,CAAC,kDAAkD,EAAE1B,KAAK,CAAC;MACvE,MAAM2B,KAAK,GAAG,OAAOd,EAAE,KAAK,QAAQ,IAAI,OAAO,CAACe,IAAI,CAACf,EAAE,CAAC,GAAGD,MAAM,CAACC,EAAE,CAAC,GAAGA,EAAE;MAC1E,MAAMuB,MAAM,GAAG1C,SAAS,CAAC2C,IAAI,CAAEZ,CAAC,IAAKA,CAAC,CAACZ,EAAE,KAAKc,KAAK,IAAII,MAAM,CAACN,CAAC,CAACZ,EAAE,CAAC,KAAKkB,MAAM,CAAClB,EAAE,CAAC,CAAC;MACnF,IAAIuB,MAAM,EAAE;QACVzC,YAAY,CAAEW,IAAI,IAAKA,IAAI,CAAC6B,MAAM,CAAEV,CAAC,IAAK,EAAEA,CAAC,CAACZ,EAAE,KAAKc,KAAK,IAAII,MAAM,CAACN,CAAC,CAACZ,EAAE,CAAC,KAAKkB,MAAM,CAAClB,EAAE,CAAC,CAAC,CAAC,CAAC;QAC5F,OAAO;UAAEA;QAAG,CAAC;MACf;MACAZ,OAAO,CAACD,KAAK,CAAC,4CAA4C,EAAEa,EAAE,CAAC;MAC/D,MAAMb,KAAK;IACb;EACF;EAEA,oBACET,OAAA;IAAK+C,SAAS,EAAC,KAAK;IAAAC,QAAA,eAClBhD,OAAA;MAAK+C,SAAS,EAAC,UAAU;MAAAC,QAAA,gBACvBhD,OAAA;QAAQ+C,SAAS,EAAC,YAAY;QAAAC,QAAA,eAC5BhD,OAAA;UAAI+C,SAAS,EAAC,WAAW;UAAAC,QAAA,GAAC,gBAExB,eAAAhD,OAAA;YAAM+C,SAAS,EAAC,SAAS;YAAAC,QAAA,EAAC;UAAS;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACxC;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC,CAAC,eAGTpD,OAAA,CAACP,WAAW;QAAC4D,OAAO,EAAE1C;MAAY;QAAAsC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,EAEpC/C,QAAQ,gBACPL,OAAA;QAAG+C,SAAS,EAAC,MAAM;QAAAC,QAAA,EAAC;MAAqB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC,gBAE7CpD,OAAA,CAACN,WAAW;QACVS,SAAS,EAAEA,SAAU;QACrBmD,YAAY,EAAE1B,gBAAiB;QAC/B2B,UAAU,EAAEb;MAAe;QAAAO,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC5B,CACF;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV;AAAClD,EAAA,CAhHQD,GAAG;AAAAuD,EAAA,GAAHvD,GAAG;AAkHZ,eAAeA,GAAG;AAAC,IAAAuD,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}